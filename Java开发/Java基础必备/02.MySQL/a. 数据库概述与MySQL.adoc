= 数据库概述与MySQL
:source-highlighter: highlight.js
:source-language: sql
:toc: left
:toc-title: 数据库概述与MySQL
:toclevels: 3
:sectnums:

== 为什么要使用数据库?
把数据保存到可掉电式存储设备中以供之后使用。

== 数据库与数据库管理系统
===  数据库的相关概念
==== DB：数据库（Database）
即存储数据的“仓库”，其本质是一个文件系统。它保存了一系列有组织的数据。

==== DBMS：数据库管理系统（Database Management System）
是一种操纵和管理数据库的大型软件，用于建立、使用和维护数据库，对数据库进行统一管理和控制。用户通过数据库管理系统访问数据库中表内的数据。

==== SQL：结构化查询语言（Structured Query Language）
专门用来与数据库通信的语言。

=== 常见数据库管理系统
- MySQL
- Oracle
- SQL Server：微软开发的大型商业数据库。
- DB2：IBM公司的数据库产品,收费的。常应用在银行系统中。

== 关于MySQL
=== Why choose MySQL?
. 开放源代码，使用成本低。
. 性能卓越，服务稳定。
. 软件体积小，使用简单，并且易于维护。
. 历史悠久，社区用户非常活跃，遇到问题可以寻求帮助。
. 许多互联网公司在用，经过了时间的验证。

=== Oracle vs MySQL
- Oracle 更适合大型跨国企业的使用，因为他们对费用不敏感，但是对性能要求以及安全性有更高的要求。
- MySQL 由于其体积小、速度快、总体拥有成本低，可处理上千万条记录的大型数据库，尤其是开放源码这一特点，使得很多互联网公司、中小型网站选择了MySQL作为网站数据库（Facebook，Twitter，YouTube，阿里巴巴/蚂蚁金服，去哪儿，美团外卖，腾讯）。

== RDBMS 与 非RDBMS
=== 关系型数据库(RDBMS)
=== 非关系型数据库(非RDBMS)
==== 键值型数据库
键值型数据库通过 Key-Value 键值的方式来存储数据，其中 Key 和 Value 可以是简单的对象，也可以是复杂的对象。Key 作为唯一的标识符，优点是查找速度快，在这方面明显优于关系型数据库，缺点是无法像关系型数据库一样使用条件过滤（比如 WHERE）。

键值型数据库典型的使用场景是作为 内存缓存 。 Redis 是最流行的键值型数据库。

==== 文档型数据库
此类数据库可存放并获取文档，可以是XML、JSON等格式。在数据库中文档作为处理信息的基本单位，一个文档就相当于一条记录。文档数据库所存放的文档，就相当于键值数据库所存放的“值”。MongoDB是最流行的文档型数据库。此外，还有CouchDB等。

==== 搜索引擎数据库
Solr、Elasticsearch、Splunk

==== 列式数据库
列式数据库是相对于行式存储的数据库，Oracle、MySQL、SQL Server 等数据库都是采用的行式存储（Row-based），而列式数据库是将数据按照列存储到数据库中，这样做的好处是可以大量降低系统的I/O，适合于分布式文件系统，不足在于功能相对有限。典型产品：HBase等。

==== 图形数据库
Neo4J、InfoGrid

=== NoSQL的演变
- 1970：NoSQL = We have no SQL
- 1980：NoSQL = Know SQL
- 2000：NoSQL = No SQL!
- 2005：NoSQL = Not only SQL
- 2013：NoSQL = No, SQL!

NoSQL 对 SQL 做出了很好的补充，比如实际开发中，有很多业务需求，其实并不需要完整的关系型数据库功能，非关系型数据库的功能就足够使用了。这种情况下，使用 性能更高 、 成本更低 的非关系型数据库当然是更明智的选择。比如：日志收集、排行榜、定时器等。

== 关系型数据库设计规则
- 一个数据库中可以有多个表，每个表都有一个名字，用来标识自己。表名具有唯一性。
- 表具有一些特性，这些特性定义了数据在表中如何存储，类似Java和Python中 “类”的设计。

=== 表、记录、字段
E-R（entity-relationship，实体-联系）模型中有三个主要概念是： 实体集 、 属性 、 联系集 。

- 一个实体集（class）对应于数据库中的一个表（table），一个实体（instance）则对应于数据库表中的一行（row），也称为一条记录（record）。
- 一个属性（attribute）对应于数据库表中的一列（column），也称为一个字段（field）。

=== 表的关联关系
- 一对一（one-to-one）
- 一对多（one-to-many）
- 多对多（many-to-many）
- 自我引用(Self reference)

== MySQL的登录
=== 服务的启动与停止
==== 方式1：使用图形界面工具
. 打开windows服务
. 找到MySQL80（点击鼠标右键）→ 启动或停止（点击）

==== 方式2：使用命令行工具
----
# 启动 MySQL 服务命令：
net start MySQL服务名
# 停止 MySQL 服务命令：
net stop MySQL服务名
----

=== 登录与退出
==== 登录方式1：MySQL自带客户端
==== 登录方式2：windows命令行
----
mysql -h 主机名 -P 端口号 -u 用户名 -p密码
----
- 连接本机主机名可省略
- 端口号默认3306未修改时可省略

.例
----
mysql -h localhost -P 3306 -u root -pabc123
----

[NOTE]
====
- -p与密码之间不能有空格，其他参数名与参数值之间可以有空格也可以没有空格。
- 密码建议在下一行输入，保证安全。
+
----
mysql -h localhost -P 3306 -u root -p
Enter password:****
----
====

==== 退出登录
使用`exit`或`quit`

== MySQL的编码设置
=== MySQL5.7中
修改mysql的数据目录下的my.ini配置文件，将默认字符集更改为utf8。
----
[mysql] #大概在63行左右，在其下添加
...
default-character-set=utf8 #默认字符集
[mysqld] # 大概在76行左右，在其下添加
...
character-set-server=utf8
collation-server=utf8_general_ci
----

=== MySQL8.0中
默认为 utf8mb4，无需修改。

== MySQL目录结构
[%header, cols="2*^.^"]
|===
|MySQL的目录结构 |说明
|bin目录 |所有MySQL的可执行文件。如：mysql.exe
|MySQLInstanceConfig.exe |数据库的配置向导，在安装时出现的内容
|data目录 |系统数据库所在的目录
|my.ini文件 |MySQL的主要配置文件
|c:\ProgramData\MySQL\MySQL Server 8.0\data\ |用户创建的数据库所在的目录
|===

== SQL语言的规则与规范
=== 基本规则
. SQL 可以写在一行或者多行。为了提高可读性，各子句分行写，必要时使用缩进。
. 每条命令以 ; 或 \g 或 \G 结束。
. 关键字不能被缩写也不能分行。
. 关于标点符号：
.. 必须保证所有的()、单引号、双引号是成对结束的。
.. 必须使用英文状态下的半角输入方式。
.. 字符串型和日期时间类型的数据可以使用单引号（' '）表示。
.. 列的别名，尽量使用双引号（" "），而且不建议省略as。

=== SQL大小写规范 （建议遵守）
- MySQL 在 Windows 环境下是大小写不敏感的。
- MySQL 在 Linux 环境下是大小写敏感的：
* 数据库名、表名、表的别名、变量名是严格区分大小写的。
* 关键字、函数名、列名(或字段名)、列的别名(字段的别名) 是忽略大小写的。

推荐采用统一的书写规范：

* 数据库名、表名、表别名、字段名、字段别名等都小写。
* SQL 关键字、函数名、绑定变量等都大写。

=== 注释
- 单行注释：#注释文字(MySQL特有的方式)
- 单行注释：-- 注释文字(--后面必须包含一个空格。)
- 多行注释：/* 注释文字 */

=== 命名规则
. 数据库、表名不得超过30个字符，变量名限制为29个。
. 必须只能包含 A–Z, a–z, 0–9, _共63个字符。
. 数据库名、表名、字段名等对象名中间不要包含空格。
. 同一个MySQL软件中，数据库不能同名；同一个库中，表不能重名；同一个表中，字段不能重名。
. 必须保证你的字段没有和保留字、数据库系统或常用方法冲突。如果坚持使用，请在SQL语句中使用`（着重号）引起来。
. 保持字段名和类型的一致性，在命名字段并为其指定数据类型的时候一定要保证一致性。例如数据类型在一个表里是整数，那么另一个表里不能变成字符型。

=== SQL分类
- DDL(容器创建，修改，刷除)
- DML(插入，修改，刷除)
- DQL（查询）
- DCL（权限控制）
- TPL（事务控制语言）

== 数据导入指令
在命令行客户端登录mysql，使用source指令导入
----
mysql> source d:\mysqldb.sql
----